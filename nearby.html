<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nearby Dance Studios</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      .nearby-wrap {
        max-width: 1100px;
        margin: 0;
        padding: 0;
      }
      .nearby-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .nearby-title {
        margin: 0;
      }
      .map-frame {
        width: 100%;
        height: 60vh;
        border: 0;
        border-radius: 0;
      }
      .hint {
        color: #ccc;
        font-size: 0.9rem;
        text-align: center;
      }
      /* Force 50/50 columns for this page */
      .two-col.nearby-equal {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0;
      }
      /* Stack buttons vertically and make them full-width */
      .btn-stack {
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: stretch;
      }
      .btn-stack .btn-nearby {
        width: 100%;
        text-align: center;
      }
      .col.side {
        overflow: hidden;
        border-radius: 0;
      }
      .col.side img {
        width: 100%;
        height: auto;
        object-fit: cover;
        border-radius: 0;
        transform: none;
      }
    </style>
  </head>
  <body>
    <nav>
      <header class="navigation">
        <div class="brand">
          <h1>Dance</h1>
        </div>
      </header>
      <ul class="main-nav">
        <li><a href="index.html#history-of-dance">History of Dance</a></li>
        <li><a href="index.html#fun-facts">Fun Facts</a></li>
        <li><a href="index.html#photo-gallery">Photo Gallery</a></li>
        <li class="dropdown">
          <details class="dd">
            <summary class="dropbtn">Dance Styles ▾</summary>
            <ul class="dropdown-menu" aria-label="Dance styles">
              <li><a href="hip-hop.html">Hip Hop</a></li>
              <li><a href="ballet.html">Ballet</a></li>
              <li><a href="heels.html">Heels</a></li>
              <li><a href="line.html">Line</a></li>
              <li><a href="popping.html">Popping</a></li>
            </ul>
          </details>
        </li>
      </ul>
    </nav>
    <div class="nearby-wrap two-col nearby-equal">
      <div class="col content">
        <h1 class="nearby-title">Nearby Dance Studios</h1>
        <div class="btn-stack" aria-label="Actions">
          <a
            id="open-map-link"
            class="btn-nearby"
            target="_blank"
            rel="noopener"
            href="#"
            >Open in Google Maps</a
          >
          <a
            id="open-apple-link"
            class="btn-nearby"
            target="_blank"
            rel="noopener"
            href="#"
            >Open in Apple Maps</a
          >
          <a href="index.html" class="btn-nearby" aria-label="Back to home"
            >Back</a
          >
        </div>

        <iframe
          id="map"
          class="map-frame"
          title="Nearby dance studios map"
          src="about:blank"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
        ></iframe>

        <p class="hint">
          If the map doesn’t load: add a Google Maps Embed API key. We’ll never
          store your location.
        </p>
      </div>
      <aside class="col side">
        <img src="images/dance/2.png" alt="Dance studio visual" />
      </aside>
    </div>

    <script>
      (function () {
        // Google Maps Embed API (requires key). Paste your key below.
        const MAPS_EMBED_KEY = "";

        const iframe = document.getElementById("map");
        const googleLink = document.getElementById("open-map-link");
        const appleLink = document.getElementById("open-apple-link");

        function buildEmbedUrl(lat, lng, zoom = 13) {
          const q = encodeURIComponent("dance studio");
          return `https://www.google.com/maps/embed/v1/search?key=${MAPS_EMBED_KEY}&q=${q}&center=${lat},${lng}&zoom=${zoom}`;
        }

        function setOutputs(lat, lng) {
          const zoom = 13;
          const googleUrl = `https://www.google.com/maps/search/dance+studio/@${lat},${lng},${zoom}z`;
          const appleUrl = `https://maps.apple.com/?q=dance%20studio&ll=${lat},${lng}&z=${zoom}`;
          googleLink.href = googleUrl;
          appleLink.href = appleUrl;

          if (MAPS_EMBED_KEY) {
            iframe.src = buildEmbedUrl(lat, lng, zoom);
          } else {
            iframe.src = "about:blank";
          }
        }

        function setGeneric() {
          const googleUrl = "https://www.google.com/maps/search/dance+studio";
          const appleUrl = "https://maps.apple.com/?q=dance%20studio";
          googleLink.href = googleUrl;
          appleLink.href = appleUrl;

          if (MAPS_EMBED_KEY) {
            const url = `https://www.google.com/maps/embed/v1/search?key=${MAPS_EMBED_KEY}&q=${encodeURIComponent(
              "dance studio"
            )}`;
            iframe.src = url;
          } else {
            iframe.src = "about:blank";
          }
        }

        setGeneric();

        if ("geolocation" in navigator) {
          navigator.geolocation.getCurrentPosition(
            (pos) => {
              const { latitude, longitude } = pos.coords;
              setOutputs(latitude, longitude);
            },
            (err) => {
              console.warn("Geolocation unavailable:", err && err.message);
            },
            { enableHighAccuracy: false, timeout: 8000, maximumAge: 600000 }
          );
        }
      })();
    </script>
  </body>
</html>
